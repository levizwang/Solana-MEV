# ğŸ“˜ Scavenger ç³»ç»Ÿä½¿ç”¨æ‰‹å†Œ

> **ç‰ˆæœ¬**: 0.1.0 (Phase 2 & 3 Alpha)
> **æœ€åæ›´æ–°**: 2025-12-25

## 1. ç³»ç»Ÿç®€ä»‹
**Scavenger** æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ Solana MEV æœºå™¨äººæ¡†æ¶ï¼Œä¸“ä¸ºæ•æ‰é“¾ä¸Šå¥—åˆ©æœºä¼šè€Œè®¾è®¡ã€‚
å½“å‰ç‰ˆæœ¬å·²å®Œæˆ **Phase 3 å‡†å¤‡é˜¶æ®µ**ï¼Œå…·å¤‡ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š
*   **å…¨ç½‘ç›‘å¬**: é€šè¿‡ WebSocket å®æ—¶ç›‘å¬ Solana ä¸»ç½‘çš„æ‰€æœ‰äº¤æ˜“æ—¥å¿—ã€‚
*   **å¤šè·¯ä¾¦å¯Ÿ**: åŒæ—¶ç›‘æ§ **Raydium AMM V4** (æ–°æ± ) å’Œ **Orca Whirlpool** (ä»·æ ¼å˜åŠ¨)ã€‚
*   **æ·±åº¦è§£æ**: è‡ªåŠ¨æŠ“å–å¹¶è§£æäº¤æ˜“æ•°æ®ï¼Œæå– **Pool ID** (æ± å­åœ°å€)ã€**Token Mint A** (ä»£å¸A)ã€**Token Mint B** (ä»£å¸B)ã€‚
*   **è½»é‡çº§ AMM**: å†…ç½® Rust åŸç”Ÿå®ç°çš„ Raydium AMM çŠ¶æ€è§£æä¸ Swap ç®—æ³• (Constant Product)ï¼Œé›¶é‡å‹ SDK ä¾èµ–ã€‚
*   **ç­–ç•¥å¼•æ“ (Alpha)**: 
    *   å†…ç½® **Raydium** å’Œ **Orca** (Whirlpool) çš„ Swap æŒ‡ä»¤æ„å»ºå™¨ã€‚
    *   æ”¯æŒ **åŸå­å¥—åˆ© (Atomic Arbitrage)**: å°† "ä¹°å…¥ -> å–å‡º -> Jitoè´¿èµ‚" æ‰“åŒ…ä¸ºå•ç¬”äº¤æ˜“ï¼Œå®ç°æ— é£é™©å¥—åˆ©ï¼ˆæ¨¡æ‹Ÿå¤±è´¥å³ä¸ä¸Šé“¾ï¼‰ã€‚
*   **Jito é›†æˆ**: å·²é›†æˆ Jito Block Engine è¿æ¥ï¼Œä¸ºæœªæ¥çš„ MEV äº¤æ˜“æ‰“åŒ…åšå¥½äº†å‡†å¤‡ã€‚

---

## 2. ç¯å¢ƒå‡†å¤‡

åœ¨ä½¿ç”¨æœ¬ç³»ç»Ÿå‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

### 2.1 åŸºç¡€è½¯ä»¶
*   **æ“ä½œç³»ç»Ÿ**: macOS (æ¨è), Linux (Ubuntu 20.04+), æˆ– Windows (éœ€ WSL2)ã€‚
*   **Rust å·¥å…·é“¾**:
    ```bash
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
    ```
*   **Solana CLI** (å¯é€‰ï¼Œç”¨äºç”Ÿæˆé’±åŒ…):
    ```bash
    sh -c "$(curl -sSfL https://release.solana.com/v1.14.17/install)"
    ```

### 2.2 èŠ‚ç‚¹æœåŠ¡ (RPC)
æœ¬ç³»ç»Ÿä¸¥é‡ä¾èµ– RPC èŠ‚ç‚¹çš„æ€§èƒ½ã€‚
*   **Public RPC (å…è´¹)**: `https://api.mainnet-beta.solana.com`ã€‚**ä»…é™æµ‹è¯•**ï¼Œå­˜åœ¨ä¸¥é‡çš„é€Ÿç‡é™åˆ¶ (Rate Limit) å’Œå»¶è¿Ÿï¼Œä¼šå¯¼è‡´äº¤æ˜“æŠ“å–å¤±è´¥ (`Transaction not found`)ã€‚
*   **Private RPC (ä»˜è´¹)**: æ¨èä½¿ç”¨ [Helius](https://helius.xyz/), [QuickNode](https://www.quicknode.com/), æˆ– [Triton](https://triton.one/)ã€‚ä½ éœ€è¦ä¸€ä¸ª **HTTPS** åœ°å€å’Œä¸€ä¸ª **WSS** åœ°å€ã€‚

---

## 3. å¿«é€Ÿå¼€å§‹ (Quick Start)

### æ­¥éª¤ 1: å‡†å¤‡é’±åŒ…
ç³»ç»Ÿéœ€è¦ä¸¤ä¸ªé’±åŒ…æ–‡ä»¶ï¼ˆJSON æ ¼å¼ Keypairï¼‰ï¼š
1.  **Auth Wallet (`auth_key.json`)**: ç”¨äº Jito Block Engine èº«ä»½éªŒè¯ï¼ˆç›®å‰ç³»ç»Ÿæ”¯æŒæ— é‰´æƒæ¨¡å¼ï¼Œä½†å»ºè®®å‡†å¤‡ï¼‰ã€‚
2.  **Trade Wallet (`scavenger.json`)**: ç”¨äºå‘é€äº¤æ˜“å’Œæ”¯ä»˜ Gasã€‚

å¦‚æœä½ æ²¡æœ‰é’±åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ Solana CLI ç”Ÿæˆï¼š
```bash
# ç”Ÿæˆäº¤æ˜“é’±åŒ…
solana-keygen new -o scavenger.json --no-bip39-passphrase

# ç”Ÿæˆ Jito é‰´æƒé’±åŒ… (å¯ä»¥æ˜¯åŒä¸€ä¸ª)
cp scavenger.json auth_key.json
```
> âš ï¸ **æ³¨æ„**: è¯·ç¡®ä¿ `scavenger.json` ä¸­æœ‰å°‘é‡çš„ SOL (ä¾‹å¦‚ 0.01 SOL) ç”¨äºæµ‹è¯•è¿æ¥ï¼Œå°½ç®¡ç›®å‰é˜¶æ®µä¸»è¦è¿›è¡Œåªè¯»æ“ä½œã€‚

### æ­¥éª¤ 2: é…ç½®æ–‡ä»¶
åœ¨ `scavenger/` ç›®å½•ä¸‹æ‰¾åˆ° `config.toml` æ–‡ä»¶ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œè¯·æ–°å»ºä¸€ä¸ªã€‚

**é…ç½®ç¤ºä¾‹ (`scavenger/config.toml`):**
```toml
[network]
# æ›¿æ¢ä¸ºä½ è‡ªå·±çš„ RPC åœ°å€
rpc_url = "https://api.mainnet-beta.solana.com"
ws_url = "wss://api.mainnet-beta.solana.com"
# Jito Block Engine (é€šå¸¸æ— éœ€æ›´æ”¹)
grpc_url = "https://amsterdam.mainnet.block-engine.jito.wtf"

[jito]
block_engine_url = "https://amsterdam.mainnet.block-engine.jito.wtf"
auth_keypair_path = "./auth_key.json"

[strategy]
wallet_path = "./scavenger.json"
trade_amount_sol = 0.001
static_tip_sol = 0.001
dynamic_tip_ratio = 0.5
max_tip_sol = 0.002  # æœ€å¤§å…è®¸å°è´¹ï¼Œè¶…è¿‡æ­¤å€¼ä¼šç†”æ–­

[log]
level = "info"
```

### æ­¥éª¤ 3: è¿è¡Œç³»ç»Ÿ
è¿›å…¥é¡¹ç›®ç›®å½•å¹¶è¿è¡Œï¼š
```bash
cd scavenger
cargo run --bin scavenger
```

---

## 4. è¿è¡ŒçŠ¶æ€è§£è¯»

å½“æ‚¨çœ‹åˆ°ä»¥ä¸‹æ—¥å¿—æ—¶ï¼Œè¯´æ˜ç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼š

1.  **å¯åŠ¨æˆåŠŸ**:
    ```text
    ğŸš€ Scavenger (æ‹¾è’è€…) MEV Bot æ­£åœ¨å¯åŠ¨...
    âœ… RPC è¿æ¥æˆåŠŸ...
    âœ… Jito Searcher Client è¿æ¥æˆåŠŸ...
    ğŸ“¦ æ­£åœ¨æ„å»ºå…¨ç½‘ä»£å¸ç´¢å¼• (Inventory)...
    âœ… æˆåŠŸåŠ è½½ 156 ä¸ªå…±æœ‰å¥—åˆ©å¯¹ (Raydium <-> Orca)
    ```

2.  **å¼€å§‹ç›‘å¬**:
    ```text
    ğŸ”Œ è¿æ¥ WebSocket: wss://...
    âœ… WebSocket è¿æ¥æˆåŠŸ...
    ğŸ‘€ æ­£åœ¨ç›‘å¬ 312 ä¸ªç›¸å…³æ± å­çš„ Account Update...
    ```

3.  **å‘ç°æ–°æ± å­**:
    å½“é“¾ä¸Šæœ‰äººåˆ›å»ºæ–°æ± å­æ—¶ï¼Œä½ ä¼šç«‹å³çœ‹åˆ°ï¼š
    ```text
    âœ¨ [Raydium] å‘ç°æ½œåœ¨æ´»åŠ¨! Tx: https://solscan.io/tx/5...
    ```

4.  **è·¨å¸‚åœºå¥—åˆ©è§¦å‘**:
    å½“æ£€æµ‹åˆ° Orca ä¸Šçš„å¤§é¢å˜åŠ¨æ—¶ï¼š
    ```text
    ğŸŒŠ [Orca] æˆåŠŸè§£ææ± å­è¯¦æƒ…...
    âš™ï¸ ç­–ç•¥å¼•æ“ (Orca): æ£€æµ‹åˆ°æ´»åŠ¨ Pool ...
    ğŸ§® é“¾ä¸Šè®¡ç®—: Pool=..., In=1000000000, Out=...
    ```

---

## 5. ç³»ç»Ÿæ¶æ„è¯´æ˜

### æ ¸å¿ƒæ¨¡å—
*   **Scout (`src/scout`)**: ç³»ç»Ÿçš„â€œçœ¼ç›â€ã€‚
    *   `monitor.rs`: ç»´æŠ¤ WebSocket é•¿è¿æ¥ï¼Œåˆ†æµ Raydium/Orca æ—¥å¿—ã€‚
    *   `raydium.rs` / `orca.rs`: ä¸“ç”¨çš„åè®®è§£æå™¨ã€‚
*   **AMM Engine (`src/amm`)**: 
    *   `raydium_v4.rs`: æ‰‹å†™å®ç°çš„ Raydium V4 çŠ¶æ€ååºåˆ—åŒ– (Borsh)ã€‚
    *   `math.rs`: åŸºäº `U256` çš„ Constant Product Swap ç®—æ³•ï¼Œç¡®ä¿è®¡ç®—ç²¾åº¦ä¸é“¾ä¸Šä¸€è‡´ã€‚
*   **Strategy (`src/strategy`)**:
    *   `quote.rs`: é›†æˆ RPC æ•°æ®ä¸æœ¬åœ° AMM ç®—æ³•ï¼Œå®ç°çœŸå®çš„é“¾ä¸Šè¯¢ä»·ã€‚
    *   `arbitrage.rs`: åŸå­äº¤æ˜“ç»„è£…å™¨ï¼Œè´Ÿè´£æ‰“åŒ… Tx + Jito Tipã€‚

### ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥æŠ“å–ï¼Ÿ
Solana çš„ `logsSubscribe` æ¨é€éå¸¸å¿«ï¼ˆæ¯«ç§’çº§ï¼‰ï¼Œä½†å®ƒåªåŒ…å«â€œå‘ç”Ÿäº†ä»€ä¹ˆâ€ï¼Œä¸åŒ…å«â€œå…·ä½“å‚æ•°â€ï¼ˆå¦‚ Token åœ°å€ï¼‰ã€‚
å› æ­¤ï¼Œæˆ‘ä»¬é‡‡å– **â€œæ¨æ‹‰ç»“åˆâ€** çš„ç­–ç•¥ï¼š
1.  **æ¨ (Push)**: WebSocket æ”¶åˆ°ä¿¡å· -> ç«‹å³é”å®šç›®æ ‡ Txã€‚
2.  **æ‹‰ (Pull)**: å¼‚æ­¥ä»»åŠ¡ç«‹å³å‘ RPC è¯·æ±‚ `getTransaction`ã€‚

---

## 6. å¸¸è§é—®é¢˜ (FAQ)

**Q: ä¸ºä»€ä¹ˆæ—¥å¿—ä¸­æ˜¾ç¤º "Jito Client æš‚æ—¶ç¦ç”¨"ï¼Ÿ**
A: ç›®å‰æˆ‘ä»¬ä¸“æ³¨äºé€šè¿‡ RPC è¿›è¡Œæ•°æ®æŠ“å–å’Œæ¨¡æ‹Ÿè®¡ç®—ã€‚Jito SDK çš„ gRPC æ¥å£åœ¨æŸäº›ç‰ˆæœ¬ä¸Šå­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œå› æ­¤æš‚æ—¶ä½¿ç”¨ HTTP RPC æ›¿ä»£ã€‚è¿™ä¸å½±å“ä¾¦å¯Ÿå’Œç­–ç•¥é€»è¾‘çš„éªŒè¯ã€‚

**Q: å¦‚ä½•åœæ­¢ç¨‹åºï¼Ÿ**
A: æŒ‰ `Ctrl + C` å³å¯å®‰å…¨é€€å‡ºã€‚
